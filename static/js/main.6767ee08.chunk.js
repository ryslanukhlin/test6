(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{204:function(e,t,n){},207:function(e,t,n){},245:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){},314:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),o=n(29),i=n.n(o),s=n(86),u=(n(203),n(39)),l=n(316),d=n(322),O=n(326),j=n(327),f=n(328),b=n(329),E=(n(204),s.c),p=n(3),v=function(e){var t,n,a=e.txt,r=e.count,c=e.collapsed,o=e.badgeKey;if(0===r)return Object(p.jsx)(p.Fragment,{children:a});var i=null===(t=document.getElementById("unicalniyId"+o))||void 0===t||null===(n=t.nextSibling)||void 0===n?void 0:n.firstChild;return"object"===typeof i&&(i.style.fontSize=c?"0px":"14px"),Object(p.jsxs)("span",{id:"unicalniyId"+o,className:"CustomBadge",children:[Object(p.jsx)("span",{className:"CustomBadge__txt",children:a}),Object(p.jsx)("span",{className:"CustomBadge__count",children:r>99?"99+":r})]})},S=n(64),_=n(9);!function(e){e.REGISTER_REQUEST="REGISTER_REQUEST",e.REGISTER_SUCCESS="REGISTER_SUCCESS",e.REGISTER_ERROR="REGISTER_ERROR",e.REGISTER_FAILED="REGISTER_FAILED",e.CLOSE_ALERT_SUCCESS="CLOSE_ALERT_SUCCESS"}(a||(a={}));var h,R={loading:!1,fetchFailed:!1,errors:null,success:!1};!function(e){e.AUTH_REQUEST="AUTH_REQUEST",e.AUTH_SUCCESS="AUTH_SUCCESS",e.AUTH_ERROR="AUTH_ERROR",e.AUTH_FAILED="AUTH_FAILED",e.CLOSE_ALERT_ERROR="CLOSE_ALERT_ERROR",e.CLEAR_AUTH="CLEAR_AUTH"}(h||(h={}));var x,A={loading:!1,token:null,error:!1,fetchFailed:!1},I=function(){return{type:h.CLEAR_AUTH}};!function(e){e.USER_GET_INFO="USER_GET_INFO",e.USER_GET_INFO_ERROR="USER_GET_INO_ERROR",e.USER_GET_INFO_SUCCESS="USER_GET_INFO_SUCCESS",e.USER_OUTPUT="USER_OUTPUT",e.USER_DOWNLOAD_AVATAR="USER_DOWNLOAD_AVATAR",e.SET_FAILED_DOWNLOAD_AVATAR="SET_FAILED_DOWNLOAD_AVATAR",e.REMOVE_FAILED_DOWNLOAD_AVATAR="REMOVE_FAILED_DOWNLOAD_AVATAR",e.CLEAR_APLICATION_FRENDS="CLEAR_APLICATION_FRENDS"}(x||(x={}));var N,m={isAuth:!1,isError:!1,user:null,loading:!0,isFailedDownloadAvatar:!1},g=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:x.USER_GET_INFO,payload:e,loading:t}},T=function(e){return{type:x.USER_GET_INFO_SUCCESS,payload:e}},C=n(106);!function(e){e.ADD_NOTIFICATION="ADD_NOTIFICATION",e.NEW_FREND_NOTIFICATION="NEW_FREND_NOTIFICATION",e.SET_FREND_NOTIFICATION="SET_FREND_NOTIFICATION",e.CLEAR_NOTIFICATION="CLEAR_NOTIFICATION",e.CLEAR_FREND_NOTIFICATION="CLEAR_FREND_NOTIFICATION",e.ADD_NOTIFICATION_MESSAGES="ADD_NOTIFICATION_MESSAGES",e.SET_NOTIFICATION_MESSAGES="SET_NOTIFICATION_MESSAGES",e.CLEAR_NOTIFICATION_MESSAGES="CLEAR_NOTIFICATION_MESSAGES"}(N||(N={}));var F,y={NotificationCount:Number(localStorage.getItem("countNotifications"))||0,newFrends:[],NotificationMessages:JSON.parse(localStorage.getItem("NotificationMessages"))||[]},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:N.ADD_NOTIFICATION,payload:e,isSaveLocalstorange:t}},D=function(e){return{type:N.SET_NOTIFICATION_MESSAGES,payload:e}};!function(e){e.SET_COLLEPSED="SET_COLLEPSED"}(F||(F={}));var w={collapsed:!1},L={registerRequest:function(e){return{type:a.REGISTER_REQUEST,payload:e}},closeAlertSuccess:function(){return{type:a.CLOSE_ALERT_SUCCESS}},authRequest:function(e,t){return{type:h.AUTH_REQUEST,payload:e,isRememberMe:t}},closeAlertError:function(){return{type:h.CLOSE_ALERT_ERROR}},userGetInfo:g,addNotification:U,clearNotification:function(){return{type:N.CLEAR_NOTIFICATION}},addNewFrendNotification:function(e){return{type:N.NEW_FREND_NOTIFICATION,payload:e}},clearFrendNotification:function(){return{type:N.CLEAR_FREND_NOTIFICATION}},setCollepsed:function(){return{type:F.SET_COLLEPSED}},addMessageNotification:function(e){return{type:N.ADD_NOTIFICATION_MESSAGES,payload:e}},clearMessageNotification:function(e){return{type:N.CLEAR_NOTIFICATION_MESSAGES,payload:e}},setMessageNotification:D,userOutput:function(){return{type:x.USER_OUTPUT}},clearAuth:I,userDownloadAvatar:function(e,t){return{type:x.USER_DOWNLOAD_AVATAR,payload:e,token:t}},semoveFailedDownloadAvatar:function(){return{type:x.REMOVE_FAILED_DOWNLOAD_AVATAR}}},M=function(){var e=Object(s.b)();return Object(S.b)(L,e)},k=l.a.Content,G=l.a.Sider,P=function(e){var t=e.children,n=E((function(e){return e.NotificationReducer})),a=n.NotificationCount,r=n.NotificationMessages,c=E((function(e){return e.PagesMetadataReducer})).collapsed,o=M().setCollepsed;return Object(p.jsxs)(l.a,{className:"Layout",children:[Object(p.jsxs)(G,{collapsible:!0,collapsed:c,onCollapse:o,style:{overflow:"auto",height:"100vh",position:"sticky",top:0,left:0},children:[Object(p.jsx)("h1",{className:"Titel",children:c?"SC":"Simple - Chat"}),Object(p.jsxs)(d.a,{theme:"dark",mode:"inline",children:[Object(p.jsx)(d.a.Item,{icon:Object(p.jsx)(O.a,{}),children:Object(p.jsx)(u.b,{to:"/",children:" \u0413\u043b\u0430\u0432\u043d\u0430\u044f"})},"1"),Object(p.jsx)(d.a.Item,{icon:Object(p.jsx)(j.a,{}),children:Object(p.jsx)(u.b,{to:"/frends",children:" \u0414\u0440\u0443\u0437\u044c\u044f"})},"2"),Object(p.jsx)(d.a.Item,{icon:c?Object(p.jsx)(v,{badgeKey:1,collapsed:c,txt:Object(p.jsx)(f.a,{}),count:a}):Object(p.jsx)(f.a,{}),children:Object(p.jsx)(u.b,{to:"/notification",children:Object(p.jsx)(v,{badgeKey:1,collapsed:c,txt:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",count:c?0:a})})},"3"),Object(p.jsx)(d.a.Item,{icon:c?Object(p.jsx)(v,{badgeKey:2,collapsed:c,txt:Object(p.jsx)(b.a,{}),count:r.length}):Object(p.jsx)(b.a,{}),children:Object(p.jsx)(u.b,{to:"/messages",children:Object(p.jsx)(v,{badgeKey:2,collapsed:c,txt:"\u0421\u043e\u043e\u0431\u0448\u0435\u043d\u0438\u044f",count:c?0:r.length})})},"4")]})]}),Object(p.jsx)(l.a,{className:"site-layout",children:Object(p.jsx)(k,{className:"site-layout-background",children:t})})]})},H=n(30),W=n(320),V=n(325),J=n(323),Q=n(189),z=n(330),B=(n(207),n(181)),q="http://80.249.148.25:8000",K=n.n(B)()(q),X=W.a.Title,Y=function(){var e=c.a.useRef(null),t=E((function(e){return e.UserReducer})),n=t.user,a=t.isFailedDownloadAvatar,r=E((function(e){return e.AuthReducer})).token,o=M(),i=o.userOutput,s=o.userDownloadAvatar,u=o.semoveFailedDownloadAvatar;return Object(p.jsxs)("div",{children:[a?Object(p.jsx)(V.a,{type:"error",message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",onClose:u,closable:!0}):null,Object(p.jsx)(J.a,{src:q+"/avatar/"+(null===n||void 0===n?void 0:n.avatar),shape:"square",size:128,icon:Object(p.jsx)(O.a,{})}),Object(p.jsx)(Q.a,{onClick:function(){var t;null===(t=e.current)||void 0===t||t.click()},className:"download__avatar",icon:Object(p.jsx)(z.a,{}),children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),Object(p.jsx)("input",{onChange:function(e){var t=new FormData;t.append("avatar",e.target.files[0]),s(t,localStorage.getItem("token")||r)},ref:e,type:"file",style:{display:"none"}}),Object(p.jsxs)(X,{className:"Title__nicname",children:["\u041d\u0438\u043a\u043d\u0435\u0439\u043c: ",null===n||void 0===n?void 0:n.nicname]}),Object(p.jsxs)(X,{className:"Title__email",level:2,children:["\u041f\u043e\u0447\u0442\u0430: ",null===n||void 0===n?void 0:n.email]}),Object(p.jsx)(Q.a,{onClick:function(){i(),K.emit("USER:LEAVR_USER",null===n||void 0===n?void 0:n._id)},type:"primary",danger:!0,children:"\u0412\u044b\u0445\u043e\u0434"})]})},Z=function(){return E((function(e){return e.UserReducer})).isAuth?Object(p.jsx)("h1",{children:"404"}):Object(p.jsx)(P,{children:Object(p.jsx)("h1",{children:"404"})})},$=n(318),ee=function(){var e=E((function(e){return e.UserReducer.user})).frends;return 0===e.length?null:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"\u0412\u0430\u0448\u0438 \u0414\u0440\u0443\u0437\u044c\u044f"}),Object(p.jsx)($.b,{dataSource:e,renderItem:function(e){return Object(p.jsx)($.b.Item,{children:Object(p.jsx)($.b.Item.Meta,{avatar:Object(p.jsx)(J.a,{src:e.avatar?q+"/avatar/"+e.avatar:"./notAvatar.jpg"}),title:e.nicname,description:e.email})})}})]})},te=n(18),ne=n.n(te),ae=n(40),re=n(37),ce=n(321),oe=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var n,a,r,c=arguments;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:"",e.next=3,fetch(q+"/searchUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,userId:t})});case 3:return a=e.sent,e.next=6,a.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e){var t=e.user,n=c.a.useState(!1),a=Object(re.a)(n,2),r=a[0],o=a[1],i=E((function(e){return e.UserReducer})).user,s=E((function(e){return e.AuthReducer})).token,u=M().userGetInfo;return Object(p.jsx)($.b.Item,{actions:[Object(p.jsx)(Q.a,{type:"link",disabled:r||(null===i||void 0===i?void 0:i.requestFrends.some((function(e){return e._id===t._id})))||(null===i||void 0===i?void 0:i.frends.some((function(e){return e._id===t._id}))),onClick:function(e,t){K.emit("USER:ADD_FREND_REQUEST",e,t),o(!0),u(s||localStorage.getItem("token"),!1)}.bind(null,null===i||void 0===i?void 0:i._id,t._id),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u0434\u0440\u0443\u0437\u044c\u044f"})],children:Object(p.jsx)($.b.Item.Meta,{avatar:Object(p.jsx)(J.a,{src:t.avatar?q+"/avatar/"+t.avatar:"./notAvatar.jpg"}),title:t.nicname,description:t.email})})},se=function(){var e=c.a.useState(),t=Object(re.a)(e,2),n=t[0],a=t[1],r=E((function(e){return e.UserReducer})).user;c.a.useEffect((function(){Object(ae.a)(ne.a.mark((function e(){var t;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe(null===r||void 0===r?void 0:r._id);case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})))()}),[]);var o=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var n;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe(null===r||void 0===r?void 0:r._id,t.target.value);case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(ce.a,{onChange:o,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f",size:"large"}),Object(p.jsx)($.b,{itemLayout:"horizontal",dataSource:n,pagination:{pageSize:3},renderItem:function(e){return Object(p.jsx)(ie,{user:e})}})]})},ue=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(se,{}),Object(p.jsx)("hr",{}),Object(p.jsx)(ee,{})]})},le=n(81),de=n(319),Oe=n(324),je=n(331),fe=n(332),be=(n(245),function(){var e=E((function(e){return e.AuthReducer})).error,t=M(),n=t.authRequest,a=t.closeAlertError,r=c.a.useState(!1),o=Object(re.a)(r,2),i=o[0],s=o[1],l=c.a.useState({email:"",password:""}),d=Object(re.a)(l,2),O=d[0],j=d[1],f=function(e){j(Object(_.a)(Object(_.a)({},O),{},Object(le.a)({},e.target.name,e.target.value)))};return Object(p.jsx)("div",{className:"wrapper",children:Object(p.jsxs)(de.a,{className:"form",children:[e?Object(p.jsx)(V.a,{message:"\u041d\u0435\u0432\u0435\u0440\u0440\u043d\u043e \u0432\u0432\u0435\u0434\u0435\u043d\u0430 \u043f\u043e\u0447\u0442\u0430 \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",type:"error",banner:!0,closable:!0,onClose:a}):null,Object(p.jsx)(de.a.Item,{children:Object(p.jsx)(ce.a,{prefix:Object(p.jsx)(je.a,{}),placeholder:"\u041f\u043e\u0447\u0442\u0430",name:"email",value:O.email,onChange:f})}),Object(p.jsx)(de.a.Item,{children:Object(p.jsx)(ce.a.Password,{prefix:Object(p.jsx)(fe.a,{}),placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",value:O.password,onChange:f})}),Object(p.jsx)(de.a.Item,{children:Object(p.jsx)(Oe.a,{onChange:s.bind(null,(function(e){return!e})),children:"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f"})}),Object(p.jsxs)(de.a.Item,{children:[Object(p.jsx)(Q.a,{className:"btn",type:"primary",onClick:function(){n(O,i)},children:"\u0412\u043e\u0439\u0442\u0438"}),"\u0418\u043b\u0438 ",Object(p.jsx)(u.b,{to:"/register",children:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})})}),Ee=(n(311),n(317)),pe=function(e){var t=e.message,n=c.a.useState(),a=Object(re.a)(n,2),r=a[0],o=a[1],i=c.a.useState(),s=Object(re.a)(i,2),u=s[0],l=s[1],d=E((function(e){return e.UserReducer})).user;return c.a.useEffect((function(){(null===d||void 0===d?void 0:d._id)!==t.user?(o(!1),l(null===d||void 0===d?void 0:d.frends.find((function(e){return e._id===t.user})))):o(!0)}),[]),Object(p.jsx)(Ee.a,{author:r?null===d||void 0===d?void 0:d.nicname:null===u||void 0===u?void 0:u.nicname,content:Object(p.jsx)("p",{children:t.text}),style:{backgroundColor:r?"lightblue":"white"},avatar:Object(p.jsx)(J.a,{src:r?(null===d||void 0===d?void 0:d.avatar)?q+"/avatar/"+d.avatar:"../notAvatar.jpg":(null===u||void 0===u?void 0:u.avatar)?q+"/avatar/"+u.avatar:"../notAvatar.jpg"})})},ve=function(){var e=c.a.useRef(),t=Object(H.h)().pathname.split("/")[2],n=c.a.useState([]),a=Object(re.a)(n,2),r=a[0],o=a[1],i=E((function(e){return e.PagesMetadataReducer})).collapsed,s=E((function(e){return e.NotificationReducer})).NotificationMessages,u=E((function(e){return e.UserReducer})).user,l=M().clearMessageNotification;c.a.useEffect((function(){var t=null===u||void 0===u?void 0:u.frends.find((function(e){return e._id!==(null===u||void 0===u?void 0:u._id)}));e.current=t}),[]),c.a.useEffect((function(){return K.emit("MESSAGE:JOIN_MESSAGE_ROOM",t,null===u||void 0===u?void 0:u._id),function(){o([]),K.emit("leaveMessageRoom",null===u||void 0===u?void 0:u._id)}}),[]),c.a.useEffect((function(){K.on("MESSAGE:GET_MESSAGES",(function(e){o(e)}))}),[]),c.a.useEffect((function(){K.on("MESSAGE:ACCEPT_MESSAGE",(function(e){o(e)}))}),[]),c.a.useEffect((function(){l(t)}),[s.length]);return Object(p.jsxs)(p.Fragment,{children:[0!==r.length?r.map((function(e){return Object(p.jsx)(pe,{message:e},e._id)})):null,Object(p.jsx)("div",{style:{marginTop:"40px"}}),Object(p.jsx)("div",{className:"wrapper__messageinput",style:{width:"calc(100% - ".concat(i?100:219,"px)")},children:Object(p.jsx)(ce.a.Search,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0448\u0435\u043d\u0438\u0435",size:"large",enterButton:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",onSearch:function(n){var a;K.emit("MESSAGE:SEND_MESSAGE",t,null===u||void 0===u?void 0:u._id,n,null===(a=e.current)||void 0===a?void 0:a._id)}})})]})},Se=(n(312),function(e){var t=e.room,n=c.a.useRef(),a=Object(H.g)(),r=c.a.useState(),o=Object(re.a)(r,2),i=o[0],s=o[1],u=E((function(e){return e.UserReducer})).user,l=E((function(e){return e.NotificationReducer})).NotificationMessages;c.a.useEffect((function(){var e=t.users.find((function(e){return e._id!==(null===u||void 0===u?void 0:u._id)}));n.current=e}),[]),c.a.useEffect((function(){var e=l.find((function(e){return e.roomId===t._id}));e&&s(e)}),[l]);return"undefined"===typeof n.current?null:Object(p.jsx)($.b.Item,{onClick:function(){a.push("/messages/"+t._id)},className:"MessageItem",actions:[i&&0!==i.countNewMessage?Object(p.jsxs)("div",{className:"badgeMessageItem",children:["+",null===i||void 0===i?void 0:i.countNewMessage]}):null],children:Object(p.jsx)($.b.Item.Meta,{avatar:Object(p.jsx)(J.a,{src:n.current.avatar?q+"/avatar/"+n.current.avatar:"./notAvatar.jpg"}),title:n.current.nicname,description:n.current.email})})}),_e=function(){var e=E((function(e){return e.UserReducer.user})).rooms;return 0===e.length?Object(p.jsx)("h1",{children:"\u0421\u043d\u0430\u0447\u0430\u043b\u043e \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u0432\u0435\u0441\u0442\u0438 \u0434\u0440\u0443\u0437\u0435\u0439"}):Object(p.jsx)($.b,{bordered:!0,dataSource:e,renderItem:function(e){return Object(p.jsx)(Se,{room:e})}})},he=function(){var e=E((function(e){return e.UserReducer})).user,t=E((function(e){return e.NotificationReducer})).newFrends,n=M(),a=n.clearNotification,r=n.clearFrendNotification;c.a.useEffect((function(){return a(),localStorage.removeItem("countNotifications"),e.unreadNotificationAplicationFrends.length>0&&K.emit("USER:CLEAR_UREAD_NOTIFICATION_APLICATION_FRENDS",null===e||void 0===e?void 0:e._id),e.newNotificationFrends.length>0&&K.emit("USER:CLEAR_NEW_FRENDS_NOTIFICATION",null===e||void 0===e?void 0:e._id),function(){r()}}),[]);var o=function(){var t=Object(ae.a)(ne.a.mark((function t(n){return ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:K.emit("USER:ADD_FREND",null===e||void 0===e?void 0:e._id,n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[0===(null===e||void 0===e?void 0:e.applicationFrends.length)&&0===t.length?Object(p.jsx)("h1",{children:"\u041d\u0435\u0442 \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439"}):null,0!==(null===e||void 0===e?void 0:e.applicationFrends.length)?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"\u0417\u0430\u044f\u0432\u043a\u0438 \u043d\u0430 \u0414\u0440\u0443\u0436\u0431\u0443"}),Object(p.jsx)($.b,{itemLayout:"horizontal",dataSource:null===e||void 0===e?void 0:e.applicationFrends,renderItem:function(e){return Object(p.jsx)($.b.Item,{actions:[Object(p.jsx)(Q.a,{type:"link",onClick:o.bind(null,e._id),children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u0434\u0440\u0443\u0436\u0431\u044b"})],children:Object(p.jsx)($.b.Item.Meta,{avatar:Object(p.jsx)(J.a,{src:(null===e||void 0===e?void 0:e.avatar)?q+"/avatar/"+(null===e||void 0===e?void 0:e.avatar):"./notAvatar.jpg"}),title:e.nicname,description:e.email})})}})]}):null,0!==t.length?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{children:"\u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u0434\u0440\u0443\u0436\u0431\u044b \u043f\u0440\u0438\u043d\u044f\u043b\u0438"}),Object(p.jsx)($.b,{itemLayout:"horizontal",dataSource:t,renderItem:function(e){return Object(p.jsx)($.b.Item,{children:Object(p.jsx)($.b.Item.Meta,{avatar:Object(p.jsx)(J.a,{src:(null===e||void 0===e?void 0:e.avatar)?q+"/avatar/"+(null===e||void 0===e?void 0:e.avatar):"./notAvatar.jpg"}),title:e.nicname,description:e.email})})}})]}):null]})},Re=(n(313),function(){var e=E((function(e){return e.RegisterReducer})),t=e.errors,n=e.success,a=M(),r=a.registerRequest,o=a.closeAlertSuccess,i=c.a.useState({nicname:"",email:"",password:"",repeatPassword:""}),s=Object(re.a)(i,2),l=s[0],d=s[1],j=function(e){d(Object(_.a)(Object(_.a)({},l),{},Object(le.a)({},e.target.name,e.target.value)))};return Object(p.jsx)("div",{className:"wrapper",children:Object(p.jsxs)(de.a,{className:"form",children:[n?Object(p.jsx)(V.a,{message:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e",type:"success",banner:!0,closable:!0,onClose:function(){o()}}):null,Object(p.jsx)(de.a.Item,{validateStatus:(null===t||void 0===t?void 0:t.nicname)?"error":"success",help:null===t||void 0===t?void 0:t.nicname,children:Object(p.jsx)(ce.a,{name:"nicname",value:l.nicname,onChange:j,prefix:Object(p.jsx)(O.a,{}),placeholder:"\u041b\u043e\u0433\u0438\u043d"})}),Object(p.jsx)(de.a.Item,{validateStatus:(null===t||void 0===t?void 0:t.email)?"error":"success",help:null===t||void 0===t?void 0:t.email,children:Object(p.jsx)(ce.a,{name:"email",value:l.email,onChange:j,prefix:Object(p.jsx)(je.a,{}),placeholder:"\u041f\u043e\u0447\u0442\u0430"})}),Object(p.jsx)(de.a.Item,{validateStatus:(null===t||void 0===t?void 0:t.password)?"error":"success",help:null===t||void 0===t?void 0:t.password,children:Object(p.jsx)(ce.a.Password,{name:"password",value:l.password,onChange:j,prefix:Object(p.jsx)(fe.a,{}),placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"})}),Object(p.jsx)(de.a.Item,{validateStatus:(null===t||void 0===t?void 0:t.repeatPassword)?"error":"success",help:null===t||void 0===t?void 0:t.repeatPassword,children:Object(p.jsx)(ce.a.Password,{name:"repeatPassword",value:l.repeatPassword,onChange:j,prefix:Object(p.jsx)(fe.a,{}),placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u041f\u0430\u0440\u043e\u043b\u044c"})}),Object(p.jsxs)(de.a.Item,{children:[Object(p.jsx)(Q.a,{className:"btn",type:"primary",onClick:function(){r(l)},children:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),"\u0418\u043b\u0438 ",Object(p.jsx)(u.b,{to:"/login",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}),xe=n(193),Ae=["component","auth"],Ie=function(e){var t=e.component,n=e.auth,a=Object(xe.a)(e,Ae);return Object(p.jsx)(H.b,{render:function(){return!1===n?Object(p.jsx)(H.a,{to:"/login"}):Object(p.jsx)(t,Object(_.a)({},a))}})},Ne=function(){var e=E((function(e){return e.UserReducer})).isAuth;return Object(p.jsxs)(H.d,{children:[Object(p.jsx)(Ie,{auth:e,exact:!0,path:"/",component:Y}),Object(p.jsx)(Ie,{auth:e,exact:!0,path:"/frends",component:ue}),Object(p.jsx)(Ie,{auth:e,exact:!0,path:"/notification",component:he}),Object(p.jsx)(Ie,{auth:e,exact:!0,path:"/messages",component:_e}),Object(p.jsx)(Ie,{auth:e,exact:!0,path:"/messages/:MessageRoomId",component:ve}),Object(p.jsx)(H.b,{exact:!0,path:"/login",component:function(){return e?Object(p.jsx)(H.a,{to:"/"}):Object(p.jsx)(be,{})}}),Object(p.jsx)(H.b,{exact:!0,path:"/register",component:function(){return e?Object(p.jsx)(H.a,{to:"/"}):Object(p.jsx)(Re,{})}}),Object(p.jsx)(H.b,{path:"*",component:Z})]})},me=function(){var e=E((function(e){return e.UserReducer})),t=e.isAuth,n=e.loading,a=E((function(e){return e.AuthReducer})).token,r=c.a.useRef(a),o=M(),i=o.userGetInfo,s=o.addNotification,l=o.addNewFrendNotification,d=o.addMessageNotification;return a&&(r.current=a),c.a.useEffect((function(){i(a||localStorage.getItem("token"))}),[]),c.a.useEffect((function(){K.on("USER:Notification_ADD_FREND",(function(){s(),i(r.current||localStorage.getItem("token"),!1)}))}),[]),c.a.useEffect((function(){K.on("USER:USER:ADD_FREND_SUCCESS",(function(e){s(),l(e),i(r.current||localStorage.getItem("token"),!1)}))}),[]),c.a.useEffect((function(){K.on("MESSAGE:ADD_NOTIFICATIOM_NEW_MESSAGE",(function(e){d(e),i(r.current||localStorage.getItem("token"),!1)}))}),[]),c.a.useEffect((function(){K.on("USER:ADD_FREND_SUCCESS",(function(){i(r.current||localStorage.getItem("token"),!1)}))}),[]),c.a.useEffect((function(){K.on("USER:ADD_FREND_SUCCESS",(function(){i(r.current||localStorage.getItem("token"),!1)}))}),[]),n?Object(p.jsx)(p.Fragment,{}):Object(p.jsx)(u.a,{children:t?Object(p.jsx)(P,{children:Object(p.jsx)(Ne,{})}):Object(p.jsx)(Ne,{})})},ge=n(190),Te=n(28),Ce=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var n,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(q+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=ne.a.mark(Ue),ye=ne.a.mark(De);function Ue(e){var t;return ne.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(Te.b)(Ce.bind(null,e.payload));case 3:if(!(t=n.sent).error){n.next=9;break}return n.next=7,Object(Te.c)({type:h.AUTH_ERROR});case 7:n.next=14;break;case 9:return e.isRememberMe&&localStorage.setItem("token",t.token),n.next=12,Object(Te.c)((a=t.token,{type:h.AUTH_SUCCESS,payload:a}));case 12:return n.next=14,Object(Te.c)(g(t.token));case 14:n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(0),n.next=20,Object(Te.c)({type:h.AUTH_FAILED});case 20:case"end":return n.stop()}var a}),Fe,null,[[0,16]])}function De(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Te.d)(h.AUTH_REQUEST,Ue);case 2:case"end":return e.stop()}}),ye)}var we=n(94),Le=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var n,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(q+"/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=ne.a.mark(Ge),ke=ne.a.mark(Pe);function Ge(e){var t;return ne.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(we.a)(Le.bind(null,e.payload));case 3:if(!(t=n.sent).validErr){n.next=9;break}return n.next=7,Object(we.b)((r=t.errors,{type:a.REGISTER_ERROR,payload:r}));case 7:n.next=11;break;case 9:return n.next=11,Object(we.b)({type:a.REGISTER_SUCCESS});case 11:n.next=17;break;case 13:return n.prev=13,n.t0=n.catch(0),n.next=17,Object(we.b)({type:a.REGISTER_FAILED});case 17:case"end":return n.stop()}var r}),Me,null,[[0,13]])}function Pe(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(we.c)(a.REGISTER_REQUEST,Ge);case 2:case"end":return e.stop()}}),ke)}var He=function(){var e=Object(ae.a)(ne.a.mark((function e(t){var n,a;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(q+"/user",{method:"GET",headers:{Authorization:"Bearer "+t}});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=Object(ae.a)(ne.a.mark((function e(t,n){var a,r;return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(q+"/downloadIcon",{method:"POST",headers:{Authorization:"Bearer "+n},body:t});case 2:if(200===(a=e.sent).status){e.next=5;break}throw new Error;case 5:return e.next=7,a.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=ne.a.mark(Be),Je=ne.a.mark(qe),Qe=ne.a.mark(Ke),ze=ne.a.mark(Xe);function Be(e){var t;return ne.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(Te.b)(He.bind(null,e.payload));case 3:return t=n.sent,n.next=6,Object(Te.c)(T(t));case 6:if(!(t.unreadMessages.length>0)){n.next=9;break}return n.next=9,Object(Te.c)(D(t.unreadMessages));case 9:if(!(t.unreadNotificationAplicationFrends.length>0)){n.next=12;break}return n.next=12,Object(Te.c)(U(t.unreadNotificationAplicationFrends.length,!1));case 12:if(!(t.newNotificationFrends.length>0)){n.next=15;break}return n.next=15,Object(Te.c)((a=t.newNotificationFrends,{type:N.SET_FREND_NOTIFICATION,payload:a}));case 15:e.loading&&K.emit("USER:JOIN_USER",t._id),n.next=22;break;case 18:return n.prev=18,n.t0=n.catch(0),n.next=22,Object(Te.c)({type:x.USER_GET_INFO_ERROR});case 22:case"end":return n.stop()}var a}),Ve,null,[[0,18]])}function qe(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("token"),e.next=3,Object(Te.c)(I());case 3:case"end":return e.stop()}}),Je)}function Ke(e){var t,n,a;return ne.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t=e.payload,n=e.token,r.next=4,Object(Te.b)(We.bind(null,t,n));case 4:return a=r.sent,r.next=7,Object(Te.c)(T(a));case 7:r.next=13;break;case 9:return r.prev=9,r.t0=r.catch(0),r.next=13,Object(Te.c)({type:x.SET_FAILED_DOWNLOAD_AVATAR});case 13:case"end":return r.stop()}}),Qe,null,[[0,9]])}function Xe(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Te.d)(x.USER_GET_INFO,Be);case 2:return e.next=4,Object(Te.d)(x.USER_OUTPUT,qe);case 4:return e.next=6,Object(Te.d)(x.USER_DOWNLOAD_AVATAR,Ke);case 6:case"end":return e.stop()}}),ze)}var Ye=ne.a.mark(Ze);function Ze(){return ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Te.a)([Pe(),De(),Xe()]);case 2:case"end":return e.stop()}}),Ye)}var $e=Object(S.c)({AuthReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.AUTH_REQUEST:return Object(_.a)(Object(_.a)({},A),{},{loading:!0});case h.AUTH_SUCCESS:return Object(_.a)(Object(_.a)({},e),{},{loading:!1,token:t.payload});case h.AUTH_ERROR:return Object(_.a)(Object(_.a)({},e),{},{loading:!1,error:!0});case h.AUTH_FAILED:return Object(_.a)(Object(_.a)({},e),{},{loading:!1,fetchFailed:!0});case h.CLOSE_ALERT_ERROR:return Object(_.a)(Object(_.a)({},e),{},{error:!1});case h.CLEAR_AUTH:return Object(_.a)(Object(_.a)({},e),{},{token:null});default:return e}},RegisterReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.REGISTER_REQUEST:return Object(_.a)(Object(_.a)({},R),{},{loading:!0});case a.REGISTER_SUCCESS:return Object(_.a)(Object(_.a)({},e),{},{success:!0,loading:!1,errors:null});case a.REGISTER_FAILED:return Object(_.a)(Object(_.a)({},e),{},{fetchFailed:!0,loading:!1});case a.REGISTER_ERROR:return Object(_.a)(Object(_.a)({},e),{},{loading:!1,errors:t.payload});case a.CLOSE_ALERT_SUCCESS:return Object(_.a)(Object(_.a)({},e),{},{success:!1});default:return e}},UserReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.USER_GET_INFO:return Object(_.a)(Object(_.a)({},e),{},{loading:t.loading});case x.USER_GET_INFO_SUCCESS:return Object(_.a)(Object(_.a)({},e),{},{isAuth:!0,user:t.payload,loading:!1});case x.USER_GET_INFO_ERROR:return Object(_.a)(Object(_.a)({},e),{},{isError:!0,loading:!1});case x.USER_OUTPUT:return Object(_.a)(Object(_.a)({},e),{},{user:null,isAuth:!1});case x.SET_FAILED_DOWNLOAD_AVATAR:return Object(_.a)(Object(_.a)({},e),{},{isFailedDownloadAvatar:!0});case x.REMOVE_FAILED_DOWNLOAD_AVATAR:return Object(_.a)(Object(_.a)({},e),{},{isFailedDownloadAvatar:!1});default:return e}},NotificationReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N.ADD_NOTIFICATION:return t.isSaveLocalstorange&&localStorage.setItem("countNotifications",String(e.NotificationCount+t.payload)),Object(_.a)(Object(_.a)({},e),{},{NotificationCount:e.NotificationCount+t.payload});case N.NEW_FREND_NOTIFICATION:return Object(_.a)(Object(_.a)({},e),{},{newFrends:[].concat(Object(C.a)(e.newFrends),[t.payload])});case N.SET_FREND_NOTIFICATION:return Object(_.a)(Object(_.a)({},e),{},{newFrends:t.payload});case N.CLEAR_NOTIFICATION:return localStorage.removeItem("countNotifications"),Object(_.a)(Object(_.a)({},e),{},{NotificationCount:0});case N.CLEAR_FREND_NOTIFICATION:return Object(_.a)(Object(_.a)({},e),{},{newFrends:[]});case N.ADD_NOTIFICATION_MESSAGES:var n=e.NotificationMessages.find((function(e){return e.roomId===t.payload}));if("undefined"!==typeof n){n.countNewMessage++;var a=[].concat(Object(C.a)(e.NotificationMessages.filter((function(e){return e.roomId!==t.payload}))),[n]);return localStorage.setItem("NotificationMessages",JSON.stringify(a)),Object(_.a)(Object(_.a)({},e),{},{NotificationMessages:a})}var r=[].concat(Object(C.a)(e.NotificationMessages),[{roomId:t.payload,countNewMessage:1}]);return localStorage.setItem("NotificationMessages",JSON.stringify(r)),Object(_.a)(Object(_.a)({},e),{},{NotificationMessages:r});case N.SET_NOTIFICATION_MESSAGES:var c=[];return t.payload.forEach((function(e){var t=c.find((function(t){return t.roomId===e.roomId}));t?t.countNewMessage++:c.push({roomId:e.roomId,countNewMessage:1})})),Object(_.a)(Object(_.a)({},e),{},{NotificationMessages:c});case N.CLEAR_NOTIFICATION_MESSAGES:var o=Object(C.a)(e.NotificationMessages.filter((function(e){return e.roomId!==t.payload})));return localStorage.setItem("NotificationMessages",JSON.stringify(o)),Object(_.a)(Object(_.a)({},e),{},{NotificationMessages:o});default:return e}},PagesMetadataReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F.SET_COLLEPSED:return Object(_.a)(Object(_.a)({},e),{},{collapsed:!e.collapsed});default:return e}}}),et=Object(ge.a)(),tt=S.d.apply(void 0,[Object(S.a)(et)].concat([])),nt=Object(S.e)($e,tt);et.run(Ze),i.a.render(Object(p.jsx)(s.a,{store:nt,children:Object(p.jsx)(me,{})}),document.getElementById("root"))}},[[314,1,2]]]);
//# sourceMappingURL=main.6767ee08.chunk.js.map